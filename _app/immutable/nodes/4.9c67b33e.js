var xt=Object.defineProperty;var Ct=(i,t,n)=>t in i?xt(i,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[t]=n;var y=(i,t,n)=>(Ct(i,typeof t!="symbol"?t+"":t,n),n);import{s as tt,f,a as C,l as bt,g,h as p,B as S,c as I,m as pt,d as _,j as v,k as R,G as Z,i as F,D as r,C as E,n as It,A as z,E as ct,H as _t,I as Bt,J as ot,K as rt,o as Tt,F as wt}from"../chunks/scheduler.2091c757.js";import{S as et,i as nt,b as j,d as Q,m as G,a as J,t as X,e as Y}from"../chunks/index.91be552e.js";import{P as yt}from"../chunks/P5.a4dbd00b.js";class kt{constructor(t=80){y(this,"audioContext");y(this,"notesInQueue",[]);y(this,"currentBeatInBar");y(this,"beatsPerBar");y(this,"currentSubdivision");y(this,"subdivisionsInBeat");y(this,"tempo");y(this,"lookahead");y(this,"scheduleAheadTime");y(this,"nextNoteTime");y(this,"isRunning");y(this,"intervalID");y(this,"onBeatStart");y(this,"onBeatEnd");this.audioContext=null,this.notesInQueue=[],this.currentBeatInBar=0,this.currentSubdivision=0,this.subdivisionsInBeat=1,this.beatsPerBar=4,this.tempo=t,this.lookahead=25,this.scheduleAheadTime=.1,this.nextNoteTime=0,this.isRunning=!1,this.intervalID=null}nextNote(){var t=60/this.subdivisionsInBeat/this.tempo;this.nextNoteTime+=t,this.currentSubdivision++,this.currentSubdivision>=this.subdivisionsInBeat&&(this.currentBeatInBar++,this.currentSubdivision=0),this.currentBeatInBar>=this.beatsPerBar&&(this.currentBeatInBar=0)}scheduleNote(t,n,e){if(!this.audioContext)return;this.notesInQueue.push({note:t,time:e});const o=this.audioContext.createOscillator(),l=this.audioContext.createGain(),a=1e3,h=400,m=200;n!==0?o.frequency.value=m:t%this.beatsPerBar===0?o.frequency.value=a:o.frequency.value=h,l.gain.value=1,l.gain.exponentialRampToValueAtTime(1,e+.001),l.gain.exponentialRampToValueAtTime(.001,e+.02),o.connect(l),l.connect(this.audioContext.destination);const u=this.audioContext.createConstantSource();u.onended=()=>{this.onBeatStart&&this.onBeatStart(t,n),o.start(),o.stop(e+.03),o.onended=()=>{this.onBeatEnd&&this.onBeatEnd()}},u.start(e),u.stop(this.audioContext.currentTime+1e-4)}scheduler(){if(this.audioContext)for(;this.nextNoteTime<this.audioContext.currentTime+this.scheduleAheadTime;)this.scheduleNote(this.currentBeatInBar,this.currentSubdivision,this.nextNoteTime),this.nextNote()}start(){this.isRunning||(this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext)),this.isRunning=!0,this.currentBeatInBar=0,this.currentSubdivision=0,this.nextNoteTime=this.audioContext.currentTime+.05,this.intervalID=setInterval(()=>this.scheduler(),this.lookahead))}stop(){this.isRunning=!1,this.intervalID&&clearInterval(this.intervalID)}startStop(){this.isRunning?this.stop():this.start()}}function Vt(i){let t,n,e,o="<h4>Beats in bar</h4>",l,a,h,m="-1",u,c,b=i[0].beatsPerBar+"",T,s,d,k="+1",D,V,B,w,L,H="<h4>Subdivisions in beat</h4>",M,x,P,W='<svg width="15" height="15" fill="blue" xmlns="http://www.w3.org/2000/svg" style="width: 15px; height: auto;"><path d="M 4.3 0 v 9.6 A 2.9 2.9 0 0 0 0 12.1 A 3 3 0 0 0 3 15 c 1.5 0 2.8 -1.3 2.8 -2.9 V 3 V 0 H 4.3 Z"></path></svg>',at,A,dt='<svg width="15" height="15" fill="blue" xmlns="http://www.w3.org/2000/svg" style="width: 15px; height: auto;"><path d="M4.3 0v9.6A2.9 2.9 0 0 0 0 12.1 3 3 0 0 0 3 15c1.5 0 2.8-1.3 2.8-2.9V3h7.7v6.6a2.9 2.9 0 0 0-4.3 2.5 2.9 2.9 0 0 0 5.8 0V0H4.3Z"></path></svg>',lt,O,vt='<svg width="24" height="21" fill="blue" xmlns="http://www.w3.org/2000/svg" style="width: 24px; height: auto; top: -3px;"><path clip-rule="evenodd" d="M4.3 15.6V6H24v12.1a3 3 0 0 1-3 2.9 2.9 2.9 0 0 1-2.8-2.9 2.9 2.9 0 0 1 4.3-2.5V9H15v9.1a2.9 2.9 0 0 1-3 2.9 3 3 0 0 1-3-2.9 2.9 2.9 0 0 1 3-2.8c.5 0 1 0 1.3.3V9H5.8v9.1C5.8 19.7 4.5 21 3 21a3 3 0 0 1-3-2.9 2.9 2.9 0 0 1 4.3-2.5Z"></path><path d="M12.6 2.2 13.9.5V0h-3.1v.4h2.5l-1.4 1.7v.4h.4c.9 0 1.3.4 1.3 1s-.4 1-1.2 1c-.7 0-1.3-.3-1.6-.6l-.2.4c.4.4 1 .6 1.8.6 1.1 0 1.7-.6 1.7-1.4 0-.8-.5-1.3-1.5-1.4Z"></path></svg>',ut,U,mt='<svg width="27" height="13" fill="blue" xmlns="http://www.w3.org/2000/svg" style="width: 27px; height: auto;"><path clip-rule="evenodd" d="M3.5 0v7.9a2 2 0 0 0-1.1-.3C1 7.6 0 8.6 0 9.9c0 1.3 1 2.4 2.4 2.4 1.3 0 2.3-1 2.3-2.4V3.4H11V8a2 2 0 0 0-1.1-.3 2.3 2.3 0 1 0 0 4.7c1.3 0 2.4-1 2.4-2.4V3.4h6.1V8a2.4 2.4 0 0 0-1-.3c-1.4 0-2.5 1-2.5 2.3 0 1.3 1.1 2.4 2.4 2.4 1.3 0 2.4-1 2.4-2.4V3.4h6.2V8l-1.2-.3c-1.3 0-2.3 1-2.3 2.3a2.3 2.3 0 1 0 4.7 0V0H3.5Zm7.4 2.7H4.7V1.5H11v1.2Zm7.4 0h-6.1V1.5h6.1v1.2Zm1.3 0h6.2V1.5h-6.2v1.2Z"></path></svg>',ht,ft;return{c(){t=f("div"),n=f("div"),e=f("label"),e.innerHTML=o,l=C(),a=f("div"),h=f("button"),h.textContent=m,u=C(),c=f("span"),T=bt(b),s=C(),d=f("button"),d.textContent=k,D=C(),V=f("br"),B=C(),w=f("div"),L=f("label"),L.innerHTML=H,M=C(),x=f("div"),P=f("button"),P.innerHTML=W,at=C(),A=f("button"),A.innerHTML=dt,lt=C(),O=f("button"),O.innerHTML=vt,ut=C(),U=f("button"),U.innerHTML=mt,this.h()},l(N){t=g(N,"DIV",{class:!0});var $=p(t);n=g($,"DIV",{class:!0});var st=p(n);e=g(st,"LABEL",{for:!0,"data-svelte-h":!0}),S(e)!=="svelte-me1f1h"&&(e.innerHTML=o),l=I(st),a=g(st,"DIV",{class:!0});var K=p(a);h=g(K,"BUTTON",{"data-svelte-h":!0}),S(h)!=="svelte-bxtof5"&&(h.textContent=m),u=I(K),c=g(K,"SPAN",{style:!0});var gt=p(c);T=pt(gt,b),gt.forEach(_),s=I(K),d=g(K,"BUTTON",{"data-svelte-h":!0}),S(d)!=="svelte-1uol52n"&&(d.textContent=k),K.forEach(_),st.forEach(_),D=I($),V=g($,"BR",{}),B=I($),w=g($,"DIV",{class:!0});var it=p(w);L=g(it,"LABEL",{for:!0,"data-svelte-h":!0}),S(L)!=="svelte-x5t5k1"&&(L.innerHTML=H),M=I(it),x=g(it,"DIV",{class:!0});var q=p(x);P=g(q,"BUTTON",{class:!0,"data-svelte-h":!0}),S(P)!=="svelte-1f56wm8"&&(P.innerHTML=W),at=I(q),A=g(q,"BUTTON",{class:!0,"data-svelte-h":!0}),S(A)!=="svelte-7vfx0e"&&(A.innerHTML=dt),lt=I(q),O=g(q,"BUTTON",{class:!0,"data-svelte-h":!0}),S(O)!=="svelte-rrs8u0"&&(O.innerHTML=vt),ut=I(q),U=g(q,"BUTTON",{class:!0,"data-svelte-h":!0}),S(U)!=="svelte-uvlnii"&&(U.innerHTML=mt),q.forEach(_),it.forEach(_),$.forEach(_),this.h()},h(){v(e,"for","beatsInBar"),R(c,"font-size","large"),R(c,"margin-left","1em"),R(c,"margin-right","1em"),v(a,"class","subdivisions-container svelte-h2whv6"),v(n,"class","controls-sub-container svelte-h2whv6"),v(L,"for","subdivisionsInBeat"),v(P,"class","svelte-h2whv6"),Z(P,"selected",i[0].subdivisionsInBeat===1),v(A,"class","svelte-h2whv6"),Z(A,"selected",i[0].subdivisionsInBeat===2),v(O,"class","svelte-h2whv6"),Z(O,"selected",i[0].subdivisionsInBeat===3),v(U,"class","svelte-h2whv6"),Z(U,"selected",i[0].subdivisionsInBeat===4),v(x,"class","subdivisions-container svelte-h2whv6"),v(w,"class","controls-sub-container svelte-h2whv6"),v(t,"class","controls-container svelte-h2whv6")},m(N,$){F(N,t,$),r(t,n),r(n,e),r(n,l),r(n,a),r(a,h),r(a,u),r(a,c),r(c,T),r(a,s),r(a,d),r(t,D),r(t,V),r(t,B),r(t,w),r(w,L),r(w,M),r(w,x),r(x,P),r(x,at),r(x,A),r(x,lt),r(x,O),r(x,ut),r(x,U),ht||(ft=[E(h,"click",i[1]),E(d,"click",i[2]),E(P,"click",i[3]),E(A,"click",i[4]),E(O,"click",i[5]),E(U,"click",i[6])],ht=!0)},p(N,[$]){$&1&&b!==(b=N[0].beatsPerBar+"")&&It(T,b),$&1&&Z(P,"selected",N[0].subdivisionsInBeat===1),$&1&&Z(A,"selected",N[0].subdivisionsInBeat===2),$&1&&Z(O,"selected",N[0].subdivisionsInBeat===3),$&1&&Z(U,"selected",N[0].subdivisionsInBeat===4)},i:z,o:z,d(N){N&&_(t),ht=!1,ct(ft)}}}function Mt(i,t,n){let{metronome:e}=t;const o=()=>n(0,e.beatsPerBar=Math.max(e.beatsPerBar-1,1),e),l=()=>n(0,e.beatsPerBar=Math.min(e.beatsPerBar+1,10),e),a=()=>n(0,e.subdivisionsInBeat=1,e),h=()=>n(0,e.subdivisionsInBeat=2,e),m=()=>n(0,e.subdivisionsInBeat=3,e),u=()=>n(0,e.subdivisionsInBeat=4,e);return i.$$set=c=>{"metronome"in c&&n(0,e=c.metronome)},[e,o,l,a,h,m,u]}class Pt extends et{constructor(t){super(),nt(this,t,Mt,Vt,tt,{metronome:0})}}function $t(i){let t,n,e,o="-5",l,a,h="-1",m,u,c,b,T,s,d,k="+1",D,V,B="+5",w,L;return{c(){t=f("div"),n=f("div"),e=f("button"),e.textContent=o,l=C(),a=f("button"),a.textContent=h,m=C(),u=f("div"),c=f("input"),b=bt(" BPM"),T=C(),s=f("div"),d=f("button"),d.textContent=k,D=C(),V=f("button"),V.textContent=B,this.h()},l(H){t=g(H,"DIV",{class:!0});var M=p(t);n=g(M,"DIV",{class:!0});var x=p(n);e=g(x,"BUTTON",{"data-svelte-h":!0}),S(e)!=="svelte-boesh5"&&(e.textContent=o),l=I(x),a=g(x,"BUTTON",{"data-svelte-h":!0}),S(a)!=="svelte-1xtzs1"&&(a.textContent=h),x.forEach(_),m=I(M),u=g(M,"DIV",{class:!0});var P=p(u);c=g(P,"INPUT",{style:!0,type:!0,min:!0,max:!0}),b=pt(P," BPM"),P.forEach(_),T=I(M),s=g(M,"DIV",{class:!0});var W=p(s);d=g(W,"BUTTON",{"data-svelte-h":!0}),S(d)!=="svelte-yi7qi1"&&(d.textContent=k),D=I(W),V=g(W,"BUTTON",{"data-svelte-h":!0}),S(V)!=="svelte-5bd8rl"&&(V.textContent=B),W.forEach(_),M.forEach(_),this.h()},h(){v(n,"class","tempo-less svelte-oae4co"),R(c,"font-size","x-large"),v(c,"type","number"),v(c,"min","1"),v(c,"max","400"),v(u,"class","tempo-value svelte-oae4co"),v(s,"class","tempo-more svelte-oae4co"),v(t,"class","tempo-container svelte-oae4co")},m(H,M){F(H,t,M),r(t,n),r(n,e),r(n,l),r(n,a),r(t,m),r(t,u),r(u,c),_t(c,i[0].tempo),r(u,b),r(t,T),r(t,s),r(s,d),r(s,D),r(s,V),w||(L=[E(e,"click",i[1]),E(a,"click",i[2]),E(c,"input",i[3]),E(d,"click",i[4]),E(V,"click",i[5])],w=!0)},p(H,[M]){M&1&&Bt(c.value)!==H[0].tempo&&_t(c,H[0].tempo)},i:z,o:z,d(H){H&&_(t),w=!1,ct(L)}}}function St(i,t,n){let{metronome:e}=t;const o=()=>n(0,e.tempo=Number(e.tempo)-5,e),l=()=>n(0,e.tempo=Number(e.tempo)-1,e);function a(){e.tempo=Bt(this.value),n(0,e)}const h=()=>n(0,e.tempo=Number(e.tempo)+1,e),m=()=>n(0,e.tempo=Number(e.tempo)+5,e);return i.$$set=u=>{"metronome"in u&&n(0,e=u.metronome)},[e,o,l,a,h,m]}class Et extends et{constructor(t){super(),nt(this,t,St,$t,tt,{metronome:0})}}function Ht(i){let t,n;return{c(){t=ot("svg"),n=ot("path"),this.h()},l(e){t=rt(e,"svg",{width:!0,height:!0,fill:!0,xmlns:!0,style:!0});var o=p(t);n=rt(o,"path",{d:!0}),p(n).forEach(_),o.forEach(_),this.h()},h(){v(n,"d","M 0 0 V 20 L 17 10"),v(t,"width","20"),v(t,"height","20"),v(t,"fill","blue"),v(t,"xmlns","http://www.w3.org/2000/svg"),R(t,"width","20px"),R(t,"height","auto")},m(e,o){F(e,t,o),r(t,n)},d(e){e&&_(t)}}}function Nt(i){let t,n;return{c(){t=ot("svg"),n=ot("path"),this.h()},l(e){t=rt(e,"svg",{width:!0,height:!0,fill:!0,xmlns:!0,style:!0});var o=p(t);n=rt(o,"path",{d:!0}),p(n).forEach(_),o.forEach(_),this.h()},h(){v(n,"d","M 0 0 V 20 L 6 20 L 6 0 L 0 0 M 9 0 V 20 H 15 V 0 H 9"),v(t,"width","20"),v(t,"height","20"),v(t,"fill","blue"),v(t,"xmlns","http://www.w3.org/2000/svg"),R(t,"width","20px"),R(t,"height","auto")},m(e,o){F(e,t,o),r(t,n)},d(e){e&&_(t)}}}function Dt(i){let t,n,e,o;function l(m,u){return m[0].isRunning?Nt:Ht}let a=l(i),h=a(i);return{c(){t=f("div"),n=f("button"),h.c(),this.h()},l(m){t=g(m,"DIV",{class:!0});var u=p(t);n=g(u,"BUTTON",{style:!0});var c=p(n);h.l(c),c.forEach(_),u.forEach(_),this.h()},h(){R(n,"min-width","300px"),v(t,"class","controls-container svelte-1vpnskh")},m(m,u){F(m,t,u),r(t,n),h.m(n,null),e||(o=[E(window,"keydown",i[2]),E(n,"click",i[1])],e=!0)},p(m,[u]){a!==(a=l(m))&&(h.d(1),h=a(m),h&&(h.c(),h.m(n,null)))},i:z,o:z,d(m){m&&_(t),h.d(),e=!1,ct(o)}}}function Lt(i,t,n){let{metronome:e}=t;const o=()=>{e.startStop(),n(0,e)},l=a=>{const h=" ";if([h].includes(a.key)&&(a.preventDefault(),a.key===h)){o();return}};return i.$$set=a=>{"metronome"in a&&n(0,e=a.metronome)},[e,o,l]}class At extends et{constructor(t){super(),nt(this,t,Lt,Dt,tt,{metronome:0})}}function Ot(i){let t,n,e;return n=new yt({props:{sketch:i[0]}}),{c(){t=f("div"),j(n.$$.fragment),this.h()},l(o){t=g(o,"DIV",{id:!0,class:!0});var l=p(t);Q(n.$$.fragment,l),l.forEach(_),this.h()},h(){v(t,"id","canvas-container"),v(t,"class","d-flex justify-content-center")},m(o,l){F(o,t,l),G(n,t,null),e=!0},p:z,i(o){e||(J(n.$$.fragment,o),e=!0)},o(o){X(n.$$.fragment,o),e=!1},d(o){o&&_(t),Y(n)}}}function Ut(i,t,n){let{metronome:e}=t,o=!1,l=0,a=0;const h=(s,d)=>{o=!0,l=s,a=d},m=()=>{o=!1};let u,c="white",b="white";const T=s=>{s.setup=()=>{u=s,s.createCanvas(600,300),s.textSize(40)},s.draw=()=>{const d=document.getElementById("canvas-container");if(d){const B=(d==null?void 0:d.clientWidth)||600;s.width!==B&&s.resizeCanvas(B,Math.max(B/3,100))}s.clear(),s.stroke(c);const k=Math.min(s.width/e.beatsPerBar,s.height),D=s.height/e.subdivisionsInBeat;for(let B=0;B<e.beatsPerBar;B++){B===l?s.strokeWeight(5):s.strokeWeight(1),s.noFill(),s.circle(B*k+k/2,s.height/2,k*.9),s.strokeWeight(1);for(let w=0;w<e.subdivisionsInBeat;w++)o&&B===l&&w===a?s.fill(c):s.noFill(),s.circle(B*k+k/2,w*D+D/2,k/e.subdivisionsInBeat*.9)}o?s.fill(b):s.fill(c);const V=(l+1).toString();s.text(V,l*k+k/2-s.textWidth(V)/2,s.height/2+s.textSize()/2)}};return Tt(()=>{const s=getComputedStyle(document.body);c=s.getPropertyValue("--nc-tx-3"),b=s.getPropertyValue("--nc-tx-2"),n(1,e.onBeatStart=h,e),n(1,e.onBeatEnd=m,e)}),wt(()=>{u==null||u.remove()}),i.$$set=s=>{"metronome"in s&&n(1,e=s.metronome)},[T,e]}class Rt extends et{constructor(t){super(),nt(this,t,Ut,Ot,tt,{metronome:1})}}function zt(i){let t,n,e="Metronome",o,l,a,h,m,u,c,b,T;return l=new At({props:{metronome:i[0]}}),h=new Et({props:{metronome:i[0]}}),u=new Pt({props:{metronome:i[0]}}),b=new Rt({props:{metronome:i[0]}}),{c(){t=f("div"),n=f("h3"),n.textContent=e,o=C(),j(l.$$.fragment),a=C(),j(h.$$.fragment),m=C(),j(u.$$.fragment),c=C(),j(b.$$.fragment),this.h()},l(s){t=g(s,"DIV",{class:!0});var d=p(t);n=g(d,"H3",{"data-svelte-h":!0}),S(n)!=="svelte-1ufzmuu"&&(n.textContent=e),o=I(d),Q(l.$$.fragment,d),a=I(d),Q(h.$$.fragment,d),m=I(d),Q(u.$$.fragment,d),c=I(d),Q(b.$$.fragment,d),d.forEach(_),this.h()},h(){v(t,"class","main svelte-x7x34n")},m(s,d){F(s,t,d),r(t,n),r(t,o),G(l,t,null),r(t,a),G(h,t,null),r(t,m),G(u,t,null),r(t,c),G(b,t,null),T=!0},p:z,i(s){T||(J(l.$$.fragment,s),J(h.$$.fragment,s),J(u.$$.fragment,s),J(b.$$.fragment,s),T=!0)},o(s){X(l.$$.fragment,s),X(h.$$.fragment,s),X(u.$$.fragment,s),X(b.$$.fragment,s),T=!1},d(s){s&&_(t),Y(l),Y(h),Y(u),Y(b)}}}function qt(i){let t=new kt(80);return wt(()=>{t.stop()}),[t]}class Zt extends et{constructor(t){super(),nt(this,t,qt,zt,tt,{})}}function Wt(i){let t,n;return t=new Zt({}),{c(){j(t.$$.fragment)},l(e){Q(t.$$.fragment,e)},m(e,o){G(t,e,o),n=!0},p:z,i(e){n||(J(t.$$.fragment,e),n=!0)},o(e){X(t.$$.fragment,e),n=!1},d(e){Y(t,e)}}}class Gt extends et{constructor(t){super(),nt(this,t,null,Wt,tt,{})}}export{Gt as component};
