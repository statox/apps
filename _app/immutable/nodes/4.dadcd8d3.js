var xt=Object.defineProperty;var Tt=(s,t,n)=>t in s?xt(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n;var $=(s,t,n)=>(Tt(s,typeof t!="symbol"?t+"":t,n),n);import{s as Y,f,a as C,l as _t,g,h as T,B as E,c as I,m as bt,d as b,j as m,k as R,G as z,i as W,D as u,C as H,n as Ct,A as q,E as ht,H as pt,I as Bt,J as it,K as at,o as It,F as wt}from"../chunks/scheduler.2091c757.js";import{S as tt,i as et,b as K,d as j,m as Q,a as G,t as J,e as X}from"../chunks/index.91be552e.js";import{P as yt}from"../chunks/P5.a4dbd00b.js";import{T as kt}from"../chunks/TapTempo.075bf580.js";class $t{constructor(t=80){$(this,"audioContext");$(this,"notesInQueue",[]);$(this,"currentBeatInBar");$(this,"beatsPerBar");$(this,"currentSubdivision");$(this,"subdivisionsInBeat");$(this,"tempo");$(this,"lookahead");$(this,"scheduleAheadTime");$(this,"nextNoteTime");$(this,"isRunning");$(this,"intervalID");$(this,"onBeatStart");$(this,"onBeatEnd");this.audioContext=null,this.notesInQueue=[],this.currentBeatInBar=0,this.currentSubdivision=0,this.subdivisionsInBeat=1,this.beatsPerBar=4,this.tempo=t,this.lookahead=25,this.scheduleAheadTime=.1,this.nextNoteTime=0,this.isRunning=!1,this.intervalID=null}nextNote(){var t=60/this.subdivisionsInBeat/this.tempo;this.nextNoteTime+=t,this.currentSubdivision++,this.currentSubdivision>=this.subdivisionsInBeat&&(this.currentBeatInBar++,this.currentSubdivision=0),this.currentBeatInBar>=this.beatsPerBar&&(this.currentBeatInBar=0)}scheduleNote(t,n,e){if(!this.audioContext)return;this.notesInQueue.push({note:t,time:e});const o=this.audioContext.createOscillator(),r=this.audioContext.createGain(),a=1e3,l=400,p=200;n!==0?o.frequency.value=p:t%this.beatsPerBar===0?o.frequency.value=a:o.frequency.value=l,r.gain.value=1,r.gain.exponentialRampToValueAtTime(1,e+.001),r.gain.exponentialRampToValueAtTime(.001,e+.02),o.connect(r),r.connect(this.audioContext.destination);const c=this.audioContext.createConstantSource();c.onended=()=>{this.onBeatStart&&this.onBeatStart(t,n),o.start(),o.stop(e+.03),o.onended=()=>{this.onBeatEnd&&this.onBeatEnd()}},c.start(e),c.stop(this.audioContext.currentTime+1e-4)}scheduler(){if(this.audioContext)for(;this.nextNoteTime<this.audioContext.currentTime+this.scheduleAheadTime;)this.scheduleNote(this.currentBeatInBar,this.currentSubdivision,this.nextNoteTime),this.nextNote()}start(){this.isRunning||(this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext)),this.isRunning=!0,this.currentBeatInBar=0,this.currentSubdivision=0,this.nextNoteTime=this.audioContext.currentTime+.05,this.intervalID=setInterval(()=>this.scheduler(),this.lookahead))}stop(){this.isRunning=!1,this.intervalID&&clearInterval(this.intervalID)}startStop(){this.isRunning?this.stop():this.start()}}function Vt(s){let t,n,e,o="<h4>Beats in bar</h4>",r,a,l,p="-1",c,d,B=s[0].beatsPerBar+"",V,i,_,h="+1",v,y,w,x,D,M="<h4>Subdivisions in beat</h4>",P,k,N,F='<svg width="15" height="15" fill="blue" xmlns="http://www.w3.org/2000/svg" style="width: 15px; height: auto;"><path d="M 4.3 0 v 9.6 A 2.9 2.9 0 0 0 0 12.1 A 3 3 0 0 0 3 15 c 1.5 0 2.8 -1.3 2.8 -2.9 V 3 V 0 H 4.3 Z"></path></svg>',rt,A,dt='<svg width="15" height="15" fill="blue" xmlns="http://www.w3.org/2000/svg" style="width: 15px; height: auto;"><path d="M4.3 0v9.6A2.9 2.9 0 0 0 0 12.1 3 3 0 0 0 3 15c1.5 0 2.8-1.3 2.8-2.9V3h7.7v6.6a2.9 2.9 0 0 0-4.3 2.5 2.9 2.9 0 0 0 5.8 0V0H4.3Z"></path></svg>',lt,O,mt='<svg width="24" height="21" fill="blue" xmlns="http://www.w3.org/2000/svg" style="width: 24px; height: auto; top: -3px;"><path clip-rule="evenodd" d="M4.3 15.6V6H24v12.1a3 3 0 0 1-3 2.9 2.9 2.9 0 0 1-2.8-2.9 2.9 2.9 0 0 1 4.3-2.5V9H15v9.1a2.9 2.9 0 0 1-3 2.9 3 3 0 0 1-3-2.9 2.9 2.9 0 0 1 3-2.8c.5 0 1 0 1.3.3V9H5.8v9.1C5.8 19.7 4.5 21 3 21a3 3 0 0 1-3-2.9 2.9 2.9 0 0 1 4.3-2.5Z"></path><path d="M12.6 2.2 13.9.5V0h-3.1v.4h2.5l-1.4 1.7v.4h.4c.9 0 1.3.4 1.3 1s-.4 1-1.2 1c-.7 0-1.3-.3-1.6-.6l-.2.4c.4.4 1 .6 1.8.6 1.1 0 1.7-.6 1.7-1.4 0-.8-.5-1.3-1.5-1.4Z"></path></svg>',ut,U,vt='<svg width="27" height="13" fill="blue" xmlns="http://www.w3.org/2000/svg" style="width: 27px; height: auto;"><path clip-rule="evenodd" d="M3.5 0v7.9a2 2 0 0 0-1.1-.3C1 7.6 0 8.6 0 9.9c0 1.3 1 2.4 2.4 2.4 1.3 0 2.3-1 2.3-2.4V3.4H11V8a2 2 0 0 0-1.1-.3 2.3 2.3 0 1 0 0 4.7c1.3 0 2.4-1 2.4-2.4V3.4h6.1V8a2.4 2.4 0 0 0-1-.3c-1.4 0-2.5 1-2.5 2.3 0 1.3 1.1 2.4 2.4 2.4 1.3 0 2.4-1 2.4-2.4V3.4h6.2V8l-1.2-.3c-1.3 0-2.3 1-2.3 2.3a2.3 2.3 0 1 0 4.7 0V0H3.5Zm7.4 2.7H4.7V1.5H11v1.2Zm7.4 0h-6.1V1.5h6.1v1.2Zm1.3 0h6.2V1.5h-6.2v1.2Z"></path></svg>',ct,ft;return{c(){t=f("div"),n=f("div"),e=f("label"),e.innerHTML=o,r=C(),a=f("div"),l=f("button"),l.textContent=p,c=C(),d=f("span"),V=_t(B),i=C(),_=f("button"),_.textContent=h,v=C(),y=f("br"),w=C(),x=f("div"),D=f("label"),D.innerHTML=M,P=C(),k=f("div"),N=f("button"),N.innerHTML=F,rt=C(),A=f("button"),A.innerHTML=dt,lt=C(),O=f("button"),O.innerHTML=mt,ut=C(),U=f("button"),U.innerHTML=vt,this.h()},l(L){t=g(L,"DIV",{class:!0});var S=T(t);n=g(S,"DIV",{class:!0});var st=T(n);e=g(st,"LABEL",{for:!0,"data-svelte-h":!0}),E(e)!=="svelte-me1f1h"&&(e.innerHTML=o),r=I(st),a=g(st,"DIV",{class:!0});var nt=T(a);l=g(nt,"BUTTON",{"data-svelte-h":!0}),E(l)!=="svelte-bxtof5"&&(l.textContent=p),c=I(nt),d=g(nt,"SPAN",{style:!0});var gt=T(d);V=bt(gt,B),gt.forEach(b),i=I(nt),_=g(nt,"BUTTON",{"data-svelte-h":!0}),E(_)!=="svelte-1uol52n"&&(_.textContent=h),nt.forEach(b),st.forEach(b),v=I(S),y=g(S,"BR",{}),w=I(S),x=g(S,"DIV",{class:!0});var ot=T(x);D=g(ot,"LABEL",{for:!0,"data-svelte-h":!0}),E(D)!=="svelte-x5t5k1"&&(D.innerHTML=M),P=I(ot),k=g(ot,"DIV",{class:!0});var Z=T(k);N=g(Z,"BUTTON",{class:!0,"data-svelte-h":!0}),E(N)!=="svelte-1f56wm8"&&(N.innerHTML=F),rt=I(Z),A=g(Z,"BUTTON",{class:!0,"data-svelte-h":!0}),E(A)!=="svelte-7vfx0e"&&(A.innerHTML=dt),lt=I(Z),O=g(Z,"BUTTON",{class:!0,"data-svelte-h":!0}),E(O)!=="svelte-rrs8u0"&&(O.innerHTML=mt),ut=I(Z),U=g(Z,"BUTTON",{class:!0,"data-svelte-h":!0}),E(U)!=="svelte-uvlnii"&&(U.innerHTML=vt),Z.forEach(b),ot.forEach(b),S.forEach(b),this.h()},h(){m(e,"for","beatsInBar"),R(d,"font-size","large"),R(d,"margin-left","1em"),R(d,"margin-right","1em"),m(a,"class","subdivisions-container svelte-h2whv6"),m(n,"class","controls-sub-container svelte-h2whv6"),m(D,"for","subdivisionsInBeat"),m(N,"class","svelte-h2whv6"),z(N,"selected",s[0].subdivisionsInBeat===1),m(A,"class","svelte-h2whv6"),z(A,"selected",s[0].subdivisionsInBeat===2),m(O,"class","svelte-h2whv6"),z(O,"selected",s[0].subdivisionsInBeat===3),m(U,"class","svelte-h2whv6"),z(U,"selected",s[0].subdivisionsInBeat===4),m(k,"class","subdivisions-container svelte-h2whv6"),m(x,"class","controls-sub-container svelte-h2whv6"),m(t,"class","controls-container svelte-h2whv6")},m(L,S){W(L,t,S),u(t,n),u(n,e),u(n,r),u(n,a),u(a,l),u(a,c),u(a,d),u(d,V),u(a,i),u(a,_),u(t,v),u(t,y),u(t,w),u(t,x),u(x,D),u(x,P),u(x,k),u(k,N),u(k,rt),u(k,A),u(k,lt),u(k,O),u(k,ut),u(k,U),ct||(ft=[H(l,"click",s[1]),H(_,"click",s[2]),H(N,"click",s[3]),H(A,"click",s[4]),H(O,"click",s[5]),H(U,"click",s[6])],ct=!0)},p(L,[S]){S&1&&B!==(B=L[0].beatsPerBar+"")&&Ct(V,B),S&1&&z(N,"selected",L[0].subdivisionsInBeat===1),S&1&&z(A,"selected",L[0].subdivisionsInBeat===2),S&1&&z(O,"selected",L[0].subdivisionsInBeat===3),S&1&&z(U,"selected",L[0].subdivisionsInBeat===4)},i:q,o:q,d(L){L&&b(t),ct=!1,ht(ft)}}}function Mt(s,t,n){let{metronome:e}=t;const o=()=>n(0,e.beatsPerBar=Math.max(e.beatsPerBar-1,1),e),r=()=>n(0,e.beatsPerBar=Math.min(e.beatsPerBar+1,10),e),a=()=>n(0,e.subdivisionsInBeat=1,e),l=()=>n(0,e.subdivisionsInBeat=2,e),p=()=>n(0,e.subdivisionsInBeat=3,e),c=()=>n(0,e.subdivisionsInBeat=4,e);return s.$$set=d=>{"metronome"in d&&n(0,e=d.metronome)},[e,o,r,a,l,p,c]}class Pt extends tt{constructor(t){super(),et(this,t,Mt,Vt,Y,{metronome:0})}}function Nt(s){let t,n,e,o="-5",r,a,l="-1",p,c,d,B,V,i,_,h="+1",v,y,w="+5",x,D;return{c(){t=f("div"),n=f("div"),e=f("button"),e.textContent=o,r=C(),a=f("button"),a.textContent=l,p=C(),c=f("div"),d=f("input"),B=_t(" BPM"),V=C(),i=f("div"),_=f("button"),_.textContent=h,v=C(),y=f("button"),y.textContent=w,this.h()},l(M){t=g(M,"DIV",{class:!0});var P=T(t);n=g(P,"DIV",{class:!0});var k=T(n);e=g(k,"BUTTON",{"data-svelte-h":!0}),E(e)!=="svelte-boesh5"&&(e.textContent=o),r=I(k),a=g(k,"BUTTON",{"data-svelte-h":!0}),E(a)!=="svelte-1xtzs1"&&(a.textContent=l),k.forEach(b),p=I(P),c=g(P,"DIV",{class:!0});var N=T(c);d=g(N,"INPUT",{style:!0,type:!0,min:!0,max:!0}),B=bt(N," BPM"),N.forEach(b),V=I(P),i=g(P,"DIV",{class:!0});var F=T(i);_=g(F,"BUTTON",{"data-svelte-h":!0}),E(_)!=="svelte-yi7qi1"&&(_.textContent=h),v=I(F),y=g(F,"BUTTON",{"data-svelte-h":!0}),E(y)!=="svelte-5bd8rl"&&(y.textContent=w),F.forEach(b),P.forEach(b),this.h()},h(){m(n,"class","tempo-less svelte-oae4co"),R(d,"font-size","x-large"),m(d,"type","number"),m(d,"min","1"),m(d,"max","400"),m(c,"class","tempo-value svelte-oae4co"),m(i,"class","tempo-more svelte-oae4co"),m(t,"class","tempo-container svelte-oae4co")},m(M,P){W(M,t,P),u(t,n),u(n,e),u(n,r),u(n,a),u(t,p),u(t,c),u(c,d),pt(d,s[0].tempo),u(c,B),u(t,V),u(t,i),u(i,_),u(i,v),u(i,y),x||(D=[H(e,"click",s[1]),H(a,"click",s[2]),H(d,"input",s[3]),H(_,"click",s[4]),H(y,"click",s[5])],x=!0)},p(M,[P]){P&1&&Bt(d.value)!==M[0].tempo&&pt(d,M[0].tempo)},i:q,o:q,d(M){M&&b(t),x=!1,ht(D)}}}function St(s,t,n){let{metronome:e}=t;const o=()=>n(0,e.tempo=Number(e.tempo)-5,e),r=()=>n(0,e.tempo=Number(e.tempo)-1,e);function a(){e.tempo=Bt(this.value),n(0,e)}const l=()=>n(0,e.tempo=Number(e.tempo)+1,e),p=()=>n(0,e.tempo=Number(e.tempo)+5,e);return s.$$set=c=>{"metronome"in c&&n(0,e=c.metronome)},[e,o,r,a,l,p]}class Et extends tt{constructor(t){super(),et(this,t,St,Nt,Y,{metronome:0})}}function Ht(s){let t,n;return{c(){t=it("svg"),n=it("path"),this.h()},l(e){t=at(e,"svg",{width:!0,height:!0,fill:!0,xmlns:!0,style:!0});var o=T(t);n=at(o,"path",{d:!0}),T(n).forEach(b),o.forEach(b),this.h()},h(){m(n,"d","M 0 0 V 20 L 17 10"),m(t,"width","20"),m(t,"height","20"),m(t,"fill","blue"),m(t,"xmlns","http://www.w3.org/2000/svg"),R(t,"width","20px"),R(t,"height","auto")},m(e,o){W(e,t,o),u(t,n)},d(e){e&&b(t)}}}function Dt(s){let t,n;return{c(){t=it("svg"),n=it("path"),this.h()},l(e){t=at(e,"svg",{width:!0,height:!0,fill:!0,xmlns:!0,style:!0});var o=T(t);n=at(o,"path",{d:!0}),T(n).forEach(b),o.forEach(b),this.h()},h(){m(n,"d","M 0 0 V 20 L 6 20 L 6 0 L 0 0 M 9 0 V 20 H 15 V 0 H 9"),m(t,"width","20"),m(t,"height","20"),m(t,"fill","blue"),m(t,"xmlns","http://www.w3.org/2000/svg"),R(t,"width","20px"),R(t,"height","auto")},m(e,o){W(e,t,o),u(t,n)},d(e){e&&b(t)}}}function Lt(s){let t,n,e,o;function r(p,c){return p[0].isRunning?Dt:Ht}let a=r(s),l=a(s);return{c(){t=f("div"),n=f("button"),l.c(),this.h()},l(p){t=g(p,"DIV",{class:!0});var c=T(t);n=g(c,"BUTTON",{style:!0});var d=T(n);l.l(d),d.forEach(b),c.forEach(b),this.h()},h(){R(n,"min-width","300px"),m(t,"class","controls-container svelte-1vpnskh")},m(p,c){W(p,t,c),u(t,n),l.m(n,null),e||(o=[H(window,"keydown",s[2]),H(n,"click",s[1])],e=!0)},p(p,[c]){a!==(a=r(p))&&(l.d(1),l=a(p),l&&(l.c(),l.m(n,null)))},i:q,o:q,d(p){p&&b(t),l.d(),e=!1,ht(o)}}}function At(s,t,n){let{metronome:e}=t;const o=()=>{e.startStop(),n(0,e)},r=a=>{const l=" ";if([l].includes(a.key)&&(a.preventDefault(),a.key===l)){o();return}};return s.$$set=a=>{"metronome"in a&&n(0,e=a.metronome)},[e,o,r]}class Ot extends tt{constructor(t){super(),et(this,t,At,Lt,Y,{metronome:0})}}function Ut(s){let t,n,e;return n=new yt({props:{sketch:s[0]}}),{c(){t=f("div"),K(n.$$.fragment),this.h()},l(o){t=g(o,"DIV",{id:!0,class:!0});var r=T(t);j(n.$$.fragment,r),r.forEach(b),this.h()},h(){m(t,"id","canvas-container"),m(t,"class","d-flex justify-content-center")},m(o,r){W(o,t,r),Q(n,t,null),e=!0},p:q,i(o){e||(G(n.$$.fragment,o),e=!0)},o(o){J(n.$$.fragment,o),e=!1},d(o){o&&b(t),X(n)}}}function zt(s,t,n){let{metronome:e}=t,o=!1,r=0,a=0;const l=(i,_)=>{o=!0,r=i,a=_},p=()=>{o=!1};let c,d="white",B="white";const V=i=>{i.setup=()=>{c=i,i.createCanvas(600,300),i.textSize(40)},i.draw=()=>{const _=document.getElementById("canvas-container");if(_){const w=(_==null?void 0:_.clientWidth)||600;i.width!==w&&i.resizeCanvas(w,Math.max(w/3,100))}i.clear(),i.stroke(d);const h=Math.min(i.width/e.beatsPerBar,i.height),v=i.height/e.subdivisionsInBeat;for(let w=0;w<e.beatsPerBar;w++){w===r?i.strokeWeight(5):i.strokeWeight(1),i.noFill(),i.circle(w*h+h/2,i.height/2,h*.9),i.strokeWeight(1);for(let x=0;x<e.subdivisionsInBeat;x++)o&&w===r&&x===a?i.fill(d):i.noFill(),i.circle(w*h+h/2,x*v+v/2,h/e.subdivisionsInBeat*.9)}o?i.fill(B):i.fill(d),i.fill(d);const y=(r+1).toString();i.text(y,r*h+h/2-i.textWidth(y)/2,i.height/2+i.textSize()/2)}};return It(()=>{const i=getComputedStyle(document.body);d=i.getPropertyValue("--nc-tx-3"),B=i.getPropertyValue("--nc-tx-2"),n(1,e.onBeatStart=l,e),n(1,e.onBeatEnd=p,e)}),wt(()=>{c==null||c.remove()}),s.$$set=i=>{"metronome"in i&&n(1,e=i.metronome)},[V,e]}class Rt extends tt{constructor(t){super(),et(this,t,zt,Ut,Y,{metronome:1})}}function qt(s){let t,n,e="Tap",o,r;return{c(){t=f("div"),n=f("button"),n.textContent=e,this.h()},l(a){t=g(a,"DIV",{class:!0});var l=T(t);n=g(l,"BUTTON",{style:!0,class:!0,"data-svelte-h":!0}),E(n)!=="svelte-1yc9fay"&&(n.textContent=e),l.forEach(b),this.h()},h(){R(n,"min-width","300px"),m(n,"class","svelte-1936oze"),z(n,"taped",s[0]),m(t,"class","controls-container svelte-1936oze")},m(a,l){W(a,t,l),u(t,n),o||(r=H(n,"click",s[1]),o=!0)},p(a,[l]){l&1&&z(n,"taped",a[0])},i:q,o:q,d(a){a&&b(t),o=!1,r()}}}function Zt(s,t,n){let{onNewBPM:e}=t,o=new kt,r=!1;const a=()=>{o.addBeat(),n(0,r=!0),setTimeout(()=>n(0,r=!1),100),e(o.bpm)};return s.$$set=l=>{"onNewBPM"in l&&n(2,e=l.onNewBPM)},[r,a,e]}class Wt extends tt{constructor(t){super(),et(this,t,Zt,qt,Y,{onNewBPM:2})}}function Ft(s){let t,n,e="Metronome",o,r,a,l,p,c,d,B,V,i,_;return r=new Ot({props:{metronome:s[0]}}),l=new Et({props:{metronome:s[0]}}),c=new Wt({props:{onNewBPM:s[1]}}),B=new Pt({props:{metronome:s[0]}}),i=new Rt({props:{metronome:s[0]}}),{c(){t=f("div"),n=f("h3"),n.textContent=e,o=C(),K(r.$$.fragment),a=C(),K(l.$$.fragment),p=C(),K(c.$$.fragment),d=C(),K(B.$$.fragment),V=C(),K(i.$$.fragment),this.h()},l(h){t=g(h,"DIV",{class:!0});var v=T(t);n=g(v,"H3",{"data-svelte-h":!0}),E(n)!=="svelte-1ufzmuu"&&(n.textContent=e),o=I(v),j(r.$$.fragment,v),a=I(v),j(l.$$.fragment,v),p=I(v),j(c.$$.fragment,v),d=I(v),j(B.$$.fragment,v),V=I(v),j(i.$$.fragment,v),v.forEach(b),this.h()},h(){m(t,"class","main svelte-x7x34n")},m(h,v){W(h,t,v),u(t,n),u(t,o),Q(r,t,null),u(t,a),Q(l,t,null),u(t,p),Q(c,t,null),u(t,d),Q(B,t,null),u(t,V),Q(i,t,null),_=!0},p(h,[v]){const y={};v&1&&(y.metronome=h[0]),r.$set(y);const w={};v&1&&(w.metronome=h[0]),l.$set(w);const x={};v&1&&(x.onNewBPM=h[1]),c.$set(x);const D={};v&1&&(D.metronome=h[0]),B.$set(D);const M={};v&1&&(M.metronome=h[0]),i.$set(M)},i(h){_||(G(r.$$.fragment,h),G(l.$$.fragment,h),G(c.$$.fragment,h),G(B.$$.fragment,h),G(i.$$.fragment,h),_=!0)},o(h){J(r.$$.fragment,h),J(l.$$.fragment,h),J(c.$$.fragment,h),J(B.$$.fragment,h),J(i.$$.fragment,h),_=!1},d(h){h&&b(t),X(r),X(l),X(c),X(B),X(i)}}}function Kt(s,t,n){let e=new $t(80);return wt(()=>{e.stop()}),[e,r=>{n(0,e.tempo=r,e),n(0,e)}]}class jt extends tt{constructor(t){super(),et(this,t,Kt,Ft,Y,{})}}function Qt(s){let t,n;return t=new jt({}),{c(){K(t.$$.fragment)},l(e){j(t.$$.fragment,e)},m(e,o){Q(t,e,o),n=!0},p:q,i(e){n||(G(t.$$.fragment,e),n=!0)},o(e){J(t.$$.fragment,e),n=!1},d(e){X(t,e)}}}class ee extends tt{constructor(t){super(),et(this,t,null,Qt,Y,{})}}export{ee as component};
