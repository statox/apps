var wt=Object.defineProperty;var xt=(s,t,n)=>t in s?wt(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n;var k=(s,t,n)=>(xt(s,typeof t!="symbol"?t+"":t,n),n);import{s as tt,f,a as I,l as _t,g,h as x,B as S,c as T,m as pt,d as _,j as m,k as U,G as q,i as K,D as a,C as E,n as Ct,A as Z,E as ct,H as bt,I as Bt,J as ot,K as at,o as It,F as Tt}from"../chunks/scheduler.2091c757.js";import{S as et,i as nt,b as j,d as Q,m as G,a as J,t as X,e as Y}from"../chunks/index.91be552e.js";import{P as yt}from"../chunks/P5.a4dbd00b.js";class kt{constructor(t=120,n,e){k(this,"audioContext");k(this,"notesInQueue",[]);k(this,"currentBeatInBar");k(this,"beatsPerBar");k(this,"currentSubdivision");k(this,"subdivisionsInBeat");k(this,"tempo");k(this,"lookahead");k(this,"scheduleAheadTime");k(this,"nextNoteTime");k(this,"isRunning");k(this,"intervalID");k(this,"onBeatStart");k(this,"onBeatEnd");this.audioContext=null,this.notesInQueue=[],this.currentBeatInBar=0,this.currentSubdivision=0,this.subdivisionsInBeat=1,this.beatsPerBar=4,this.tempo=t,this.lookahead=25,this.scheduleAheadTime=.1,this.nextNoteTime=0,this.isRunning=!1,this.intervalID=null,this.onBeatStart=n,this.onBeatEnd=e}nextNote(){var t=60/this.subdivisionsInBeat/this.tempo;this.nextNoteTime+=t,this.currentSubdivision++,this.currentSubdivision>=this.subdivisionsInBeat&&(this.currentBeatInBar++,this.currentSubdivision=0),this.currentBeatInBar>=this.beatsPerBar&&(this.currentBeatInBar=0)}scheduleNote(t,n,e){if(!this.audioContext)return;this.notesInQueue.push({note:t,time:e});const l=this.audioContext.createOscillator(),d=this.audioContext.createGain(),o=1e3,r=400,c=200;n!==0?l.frequency.value=c:t%this.beatsPerBar===0?l.frequency.value=o:l.frequency.value=r,d.gain.value=1,d.gain.exponentialRampToValueAtTime(1,e+.001),d.gain.exponentialRampToValueAtTime(.001,e+.02),l.connect(d),d.connect(this.audioContext.destination);const u=this.audioContext.createConstantSource();u.onended=()=>{this.onBeatStart(t,n),l.start(),l.stop(e+.03),l.onended=()=>{this.onBeatEnd()}},u.start(e),u.stop(this.audioContext.currentTime+1e-4)}scheduler(){if(this.audioContext)for(;this.nextNoteTime<this.audioContext.currentTime+this.scheduleAheadTime;)this.scheduleNote(this.currentBeatInBar,this.currentSubdivision,this.nextNoteTime),this.nextNote()}start(){this.isRunning||(this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext)),this.isRunning=!0,this.currentBeatInBar=0,this.currentSubdivision=0,this.nextNoteTime=this.audioContext.currentTime+.05,this.intervalID=setInterval(()=>this.scheduler(),this.lookahead))}stop(){this.isRunning=!1,this.intervalID&&clearInterval(this.intervalID)}startStop(){this.isRunning?this.stop():this.start()}}function Vt(s){let t,n,e,l="<h4>Beats in bar</h4>",d,o,r,c="-1",u,v,i=s[0].beatsPerBar+"",p,b,h,B="+1",w,y,W,H,D,N="<h4>Subdivisions in beat</h4>",V,C,M,z='<svg width="15" height="15" fill="blue" xmlns="http://www.w3.org/2000/svg" style="width: 15px; height: auto;"><path d="M 4.3 0 v 9.6 A 2.9 2.9 0 0 0 0 12.1 A 3 3 0 0 0 3 15 c 1.5 0 2.8 -1.3 2.8 -2.9 V 3 V 0 H 4.3 Z"></path></svg>',rt,L,dt='<svg width="15" height="15" fill="blue" xmlns="http://www.w3.org/2000/svg" style="width: 15px; height: auto;"><path d="M4.3 0v9.6A2.9 2.9 0 0 0 0 12.1 3 3 0 0 0 3 15c1.5 0 2.8-1.3 2.8-2.9V3h7.7v6.6a2.9 2.9 0 0 0-4.3 2.5 2.9 2.9 0 0 0 5.8 0V0H4.3Z"></path></svg>',lt,A,vt='<svg width="24" height="21" fill="blue" xmlns="http://www.w3.org/2000/svg" style="width: 24px; height: auto; top: -3px;"><path clip-rule="evenodd" d="M4.3 15.6V6H24v12.1a3 3 0 0 1-3 2.9 2.9 2.9 0 0 1-2.8-2.9 2.9 2.9 0 0 1 4.3-2.5V9H15v9.1a2.9 2.9 0 0 1-3 2.9 3 3 0 0 1-3-2.9 2.9 2.9 0 0 1 3-2.8c.5 0 1 0 1.3.3V9H5.8v9.1C5.8 19.7 4.5 21 3 21a3 3 0 0 1-3-2.9 2.9 2.9 0 0 1 4.3-2.5Z"></path><path d="M12.6 2.2 13.9.5V0h-3.1v.4h2.5l-1.4 1.7v.4h.4c.9 0 1.3.4 1.3 1s-.4 1-1.2 1c-.7 0-1.3-.3-1.6-.6l-.2.4c.4.4 1 .6 1.8.6 1.1 0 1.7-.6 1.7-1.4 0-.8-.5-1.3-1.5-1.4Z"></path></svg>',ut,O,mt='<svg width="27" height="13" fill="blue" xmlns="http://www.w3.org/2000/svg" style="width: 27px; height: auto;"><path clip-rule="evenodd" d="M3.5 0v7.9a2 2 0 0 0-1.1-.3C1 7.6 0 8.6 0 9.9c0 1.3 1 2.4 2.4 2.4 1.3 0 2.3-1 2.3-2.4V3.4H11V8a2 2 0 0 0-1.1-.3 2.3 2.3 0 1 0 0 4.7c1.3 0 2.4-1 2.4-2.4V3.4h6.1V8a2.4 2.4 0 0 0-1-.3c-1.4 0-2.5 1-2.5 2.3 0 1.3 1.1 2.4 2.4 2.4 1.3 0 2.4-1 2.4-2.4V3.4h6.2V8l-1.2-.3c-1.3 0-2.3 1-2.3 2.3a2.3 2.3 0 1 0 4.7 0V0H3.5Zm7.4 2.7H4.7V1.5H11v1.2Zm7.4 0h-6.1V1.5h6.1v1.2Zm1.3 0h6.2V1.5h-6.2v1.2Z"></path></svg>',ht,ft;return{c(){t=f("div"),n=f("div"),e=f("label"),e.innerHTML=l,d=I(),o=f("div"),r=f("button"),r.textContent=c,u=I(),v=f("span"),p=_t(i),b=I(),h=f("button"),h.textContent=B,w=I(),y=f("br"),W=I(),H=f("div"),D=f("label"),D.innerHTML=N,V=I(),C=f("div"),M=f("button"),M.innerHTML=z,rt=I(),L=f("button"),L.innerHTML=dt,lt=I(),A=f("button"),A.innerHTML=vt,ut=I(),O=f("button"),O.innerHTML=mt,this.h()},l($){t=g($,"DIV",{class:!0});var P=x(t);n=g(P,"DIV",{class:!0});var st=x(n);e=g(st,"LABEL",{for:!0,"data-svelte-h":!0}),S(e)!=="svelte-me1f1h"&&(e.innerHTML=l),d=T(st),o=g(st,"DIV",{class:!0});var F=x(o);r=g(F,"BUTTON",{"data-svelte-h":!0}),S(r)!=="svelte-bxtof5"&&(r.textContent=c),u=T(F),v=g(F,"SPAN",{style:!0});var gt=x(v);p=pt(gt,i),gt.forEach(_),b=T(F),h=g(F,"BUTTON",{"data-svelte-h":!0}),S(h)!=="svelte-1uol52n"&&(h.textContent=B),F.forEach(_),st.forEach(_),w=T(P),y=g(P,"BR",{}),W=T(P),H=g(P,"DIV",{class:!0});var it=x(H);D=g(it,"LABEL",{for:!0,"data-svelte-h":!0}),S(D)!=="svelte-x5t5k1"&&(D.innerHTML=N),V=T(it),C=g(it,"DIV",{class:!0});var R=x(C);M=g(R,"BUTTON",{class:!0,"data-svelte-h":!0}),S(M)!=="svelte-1f56wm8"&&(M.innerHTML=z),rt=T(R),L=g(R,"BUTTON",{class:!0,"data-svelte-h":!0}),S(L)!=="svelte-7vfx0e"&&(L.innerHTML=dt),lt=T(R),A=g(R,"BUTTON",{class:!0,"data-svelte-h":!0}),S(A)!=="svelte-rrs8u0"&&(A.innerHTML=vt),ut=T(R),O=g(R,"BUTTON",{class:!0,"data-svelte-h":!0}),S(O)!=="svelte-uvlnii"&&(O.innerHTML=mt),R.forEach(_),it.forEach(_),P.forEach(_),this.h()},h(){m(e,"for","beatsInBar"),U(v,"font-size","large"),U(v,"margin-left","1em"),U(v,"margin-right","1em"),m(o,"class","subdivisions-container svelte-h2whv6"),m(n,"class","controls-sub-container svelte-h2whv6"),m(D,"for","subdivisionsInBeat"),m(M,"class","svelte-h2whv6"),q(M,"selected",s[0].subdivisionsInBeat===1),m(L,"class","svelte-h2whv6"),q(L,"selected",s[0].subdivisionsInBeat===2),m(A,"class","svelte-h2whv6"),q(A,"selected",s[0].subdivisionsInBeat===3),m(O,"class","svelte-h2whv6"),q(O,"selected",s[0].subdivisionsInBeat===4),m(C,"class","subdivisions-container svelte-h2whv6"),m(H,"class","controls-sub-container svelte-h2whv6"),m(t,"class","controls-container svelte-h2whv6")},m($,P){K($,t,P),a(t,n),a(n,e),a(n,d),a(n,o),a(o,r),a(o,u),a(o,v),a(v,p),a(o,b),a(o,h),a(t,w),a(t,y),a(t,W),a(t,H),a(H,D),a(H,V),a(H,C),a(C,M),a(C,rt),a(C,L),a(C,lt),a(C,A),a(C,ut),a(C,O),ht||(ft=[E(r,"click",s[1]),E(h,"click",s[2]),E(M,"click",s[3]),E(L,"click",s[4]),E(A,"click",s[5]),E(O,"click",s[6])],ht=!0)},p($,[P]){P&1&&i!==(i=$[0].beatsPerBar+"")&&Ct(p,i),P&1&&q(M,"selected",$[0].subdivisionsInBeat===1),P&1&&q(L,"selected",$[0].subdivisionsInBeat===2),P&1&&q(A,"selected",$[0].subdivisionsInBeat===3),P&1&&q(O,"selected",$[0].subdivisionsInBeat===4)},i:Z,o:Z,d($){$&&_(t),ht=!1,ct(ft)}}}function Mt(s,t,n){let{metronome:e}=t;const l=()=>n(0,e.beatsPerBar=Math.max(e.beatsPerBar-1,1),e),d=()=>n(0,e.beatsPerBar=Math.min(e.beatsPerBar+1,10),e),o=()=>n(0,e.subdivisionsInBeat=1,e),r=()=>n(0,e.subdivisionsInBeat=2,e),c=()=>n(0,e.subdivisionsInBeat=3,e),u=()=>n(0,e.subdivisionsInBeat=4,e);return s.$$set=v=>{"metronome"in v&&n(0,e=v.metronome)},[e,l,d,o,r,c,u]}class Pt extends et{constructor(t){super(),nt(this,t,Mt,Vt,tt,{metronome:0})}}function St(s){let t,n,e,l="-5",d,o,r="-1",c,u,v,i,p,b,h,B="+1",w,y,W="+5",H,D;return{c(){t=f("div"),n=f("div"),e=f("button"),e.textContent=l,d=I(),o=f("button"),o.textContent=r,c=I(),u=f("div"),v=f("input"),i=_t(" BPM"),p=I(),b=f("div"),h=f("button"),h.textContent=B,w=I(),y=f("button"),y.textContent=W,this.h()},l(N){t=g(N,"DIV",{class:!0});var V=x(t);n=g(V,"DIV",{class:!0});var C=x(n);e=g(C,"BUTTON",{"data-svelte-h":!0}),S(e)!=="svelte-boesh5"&&(e.textContent=l),d=T(C),o=g(C,"BUTTON",{"data-svelte-h":!0}),S(o)!=="svelte-1xtzs1"&&(o.textContent=r),C.forEach(_),c=T(V),u=g(V,"DIV",{class:!0});var M=x(u);v=g(M,"INPUT",{style:!0,type:!0,min:!0,max:!0}),i=pt(M," BPM"),M.forEach(_),p=T(V),b=g(V,"DIV",{class:!0});var z=x(b);h=g(z,"BUTTON",{"data-svelte-h":!0}),S(h)!=="svelte-yi7qi1"&&(h.textContent=B),w=T(z),y=g(z,"BUTTON",{"data-svelte-h":!0}),S(y)!=="svelte-5bd8rl"&&(y.textContent=W),z.forEach(_),V.forEach(_),this.h()},h(){m(n,"class","tempo-less svelte-oae4co"),U(v,"font-size","x-large"),m(v,"type","number"),m(v,"min","1"),m(v,"max","400"),m(u,"class","tempo-value svelte-oae4co"),m(b,"class","tempo-more svelte-oae4co"),m(t,"class","tempo-container svelte-oae4co")},m(N,V){K(N,t,V),a(t,n),a(n,e),a(n,d),a(n,o),a(t,c),a(t,u),a(u,v),bt(v,s[0].tempo),a(u,i),a(t,p),a(t,b),a(b,h),a(b,w),a(b,y),H||(D=[E(e,"click",s[1]),E(o,"click",s[2]),E(v,"input",s[3]),E(h,"click",s[4]),E(y,"click",s[5])],H=!0)},p(N,[V]){V&1&&Bt(v.value)!==N[0].tempo&&bt(v,N[0].tempo)},i:Z,o:Z,d(N){N&&_(t),H=!1,ct(D)}}}function Et(s,t,n){let{metronome:e}=t;const l=()=>n(0,e.tempo=Number(e.tempo)-5,e),d=()=>n(0,e.tempo=Number(e.tempo)-1,e);function o(){e.tempo=Bt(this.value),n(0,e)}const r=()=>n(0,e.tempo=Number(e.tempo)+1,e),c=()=>n(0,e.tempo=Number(e.tempo)+5,e);return s.$$set=u=>{"metronome"in u&&n(0,e=u.metronome)},[e,l,d,o,r,c]}class Ht extends et{constructor(t){super(),nt(this,t,Et,St,tt,{metronome:0})}}function Nt(s){let t,n;return{c(){t=ot("svg"),n=ot("path"),this.h()},l(e){t=at(e,"svg",{width:!0,height:!0,fill:!0,xmlns:!0,style:!0});var l=x(t);n=at(l,"path",{d:!0}),x(n).forEach(_),l.forEach(_),this.h()},h(){m(n,"d","M 0 0 V 20 L 17 10"),m(t,"width","20"),m(t,"height","20"),m(t,"fill","blue"),m(t,"xmlns","http://www.w3.org/2000/svg"),U(t,"width","20px"),U(t,"height","auto")},m(e,l){K(e,t,l),a(t,n)},d(e){e&&_(t)}}}function $t(s){let t,n;return{c(){t=ot("svg"),n=ot("path"),this.h()},l(e){t=at(e,"svg",{width:!0,height:!0,fill:!0,xmlns:!0,style:!0});var l=x(t);n=at(l,"path",{d:!0}),x(n).forEach(_),l.forEach(_),this.h()},h(){m(n,"d","M 0 0 V 20 L 6 20 L 6 0 L 0 0 M 9 0 V 20 H 15 V 0 H 9"),m(t,"width","20"),m(t,"height","20"),m(t,"fill","blue"),m(t,"xmlns","http://www.w3.org/2000/svg"),U(t,"width","20px"),U(t,"height","auto")},m(e,l){K(e,t,l),a(t,n)},d(e){e&&_(t)}}}function Dt(s){let t,n,e,l;function d(c,u){return c[0].isRunning?$t:Nt}let o=d(s),r=o(s);return{c(){t=f("div"),n=f("button"),r.c(),this.h()},l(c){t=g(c,"DIV",{class:!0});var u=x(t);n=g(u,"BUTTON",{style:!0});var v=x(n);r.l(v),v.forEach(_),u.forEach(_),this.h()},h(){U(n,"min-width","300px"),m(t,"class","controls-container svelte-1vpnskh")},m(c,u){K(c,t,u),a(t,n),r.m(n,null),e||(l=[E(window,"keydown",s[2]),E(n,"click",s[1])],e=!0)},p(c,[u]){o!==(o=d(c))&&(r.d(1),r=o(c),r&&(r.c(),r.m(n,null)))},i:Z,o:Z,d(c){c&&_(t),r.d(),e=!1,ct(l)}}}function Lt(s,t,n){let{metronome:e}=t;const l=()=>{e.startStop(),n(0,e)},d=o=>{const r=" ";if([r].includes(o.key)&&(o.preventDefault(),o.key===r)){l();return}};return s.$$set=o=>{"metronome"in o&&n(0,e=o.metronome)},[e,l,d]}class At extends et{constructor(t){super(),nt(this,t,Lt,Dt,tt,{metronome:0})}}function Ot(s){let t,n,e="Metronome",l,d,o,r,c,u,v,i,p,b;return d=new At({props:{metronome:s[0]}}),r=new Ht({props:{metronome:s[0]}}),u=new Pt({props:{metronome:s[0]}}),p=new yt({props:{sketch:s[1]}}),{c(){t=f("div"),n=f("h3"),n.textContent=e,l=I(),j(d.$$.fragment),o=I(),j(r.$$.fragment),c=I(),j(u.$$.fragment),v=I(),i=f("div"),j(p.$$.fragment),this.h()},l(h){t=g(h,"DIV",{class:!0});var B=x(t);n=g(B,"H3",{"data-svelte-h":!0}),S(n)!=="svelte-1ufzmuu"&&(n.textContent=e),l=T(B),Q(d.$$.fragment,B),o=T(B),Q(r.$$.fragment,B),c=T(B),Q(u.$$.fragment,B),v=T(B),i=g(B,"DIV",{id:!0,class:!0});var w=x(i);Q(p.$$.fragment,w),w.forEach(_),B.forEach(_),this.h()},h(){m(i,"id","canvas-container"),m(i,"class","d-flex justify-content-center"),m(t,"class","main svelte-x7x34n")},m(h,B){K(h,t,B),a(t,n),a(t,l),G(d,t,null),a(t,o),G(r,t,null),a(t,c),G(u,t,null),a(t,v),a(t,i),G(p,i,null),b=!0},p:Z,i(h){b||(J(d.$$.fragment,h),J(r.$$.fragment,h),J(u.$$.fragment,h),J(p.$$.fragment,h),b=!0)},o(h){X(d.$$.fragment,h),X(r.$$.fragment,h),X(u.$$.fragment,h),X(p.$$.fragment,h),b=!1},d(h){h&&_(t),Y(d),Y(r),Y(u),Y(p)}}}function Ut(s){let t=!1,n=0,e=0;const l=(i,p)=>{t=!0,n=i,e=p},d=()=>{t=!1};let o=new kt(80,l,d),r,c="white",u="white";const v=i=>{i.setup=()=>{r=i,i.createCanvas(600,300),i.textSize(40)},i.draw=()=>{const p=document.getElementById("canvas-container");if(p){const w=(p==null?void 0:p.clientWidth)||600;i.width!==w&&i.resizeCanvas(w,Math.max(w/3,100))}i.clear(),i.stroke(c);const b=Math.min(i.width/o.beatsPerBar,i.height),h=i.height/o.subdivisionsInBeat;for(let w=0;w<o.beatsPerBar;w++){w===n?i.strokeWeight(3):i.strokeWeight(1),i.noFill(),i.circle(w*b+b/2,i.height/2,b*.9),i.strokeWeight(1);for(let y=0;y<o.subdivisionsInBeat;y++)t&&w===n&&y===e?i.fill(c):i.noFill(),i.circle(w*b+b/2,y*h+h/2,b/o.subdivisionsInBeat*.9)}t?i.fill(u):i.fill(c);const B=(n+1).toString();i.text(B,n*b+b/2-i.textWidth(B)/2,i.height/2+i.textSize()/2)}};return It(()=>{const i=getComputedStyle(document.body);c=i.getPropertyValue("--nc-tx-3"),u=i.getPropertyValue("--nc-tx-2")}),Tt(()=>{r==null||r.remove(),o.stop()}),[o,v]}class Rt extends et{constructor(t){super(),nt(this,t,Ut,Ot,tt,{})}}function qt(s){let t,n;return t=new Rt({}),{c(){j(t.$$.fragment)},l(e){Q(t.$$.fragment,e)},m(e,l){G(t,e,l),n=!0},p:Z,i(e){n||(J(t.$$.fragment,e),n=!0)},o(e){X(t.$$.fragment,e),n=!1},d(e){Y(t,e)}}}class Kt extends et{constructor(t){super(),nt(this,t,null,qt,tt,{})}}export{Kt as component};
